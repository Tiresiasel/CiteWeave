> **This project is licensed under the Apache License 2.0. See the LICENSE file for details.**

# CiteWeave Data Structure Documentation

## ğŸ§© Graph Database Structure (Neo4j)

### Node Types

- **Paper**
  - `id`: string (SHA256, unique, generated by PaperIDGenerator)
  - `title`: string
  - `authors`: list of string
  - `year`: int or string
  - `stub`: bool (True if only referenced, not uploaded)
  - `doi`: string (optional)
  - `journal`: string (optional)
  - `publisher`: string (optional)

- **Paragraph**
  - `id`: string (e.g., `{paper_id}_para_{index}`)
  - `text`: string
  - `paragraph_index`: int
  - `section`: string (e.g., Introduction, Methods, ...)
  - `citation_count`: int
  - `sentence_count`: int
  - `has_citations`: bool (True if this paragraph contains any citations)

- **Sentence**
  - `id`: string (e.g., `{paper_id}_sent_{index}`)
  - `text`: string
  - `sentence_index`: int
  - `has_citations`: bool
  - `word_count`: int
  - `char_count`: int

- **Argument** (å¯é€‰/æ‰©å±•)
  - `id`, `text`, `claim_type`, `section`, `version`, `confidence`, `custom_tags`

### Relationship Types

- `(:Sentence)-[:BELONGS_TO]->(:Paragraph)`
- `(:Sentence)-[:BELONGS_TO]->(:Paper)`
- `(:Paragraph)-[:BELONGS_TO]->(:Paper)`
- `(:Sentence)-[:CITES]->(:Paper)`
  - `citation_text`, `citation_context`, `confidence`, `created_at`
- `(:Paragraph)-[:CITES]->(:Paper)`
  - `citation_count`, `citation_density`, `created_at`
- `(:Argument)-[:BELONGS_TO]->(:Paper)`
- `(:Argument)-[:RELATES {relation_type}]->(:Argument|Paper)`

### ç»“æ„ç¤ºæ„

```mermaid
graph TD
  Paper1[Paper]
  Para1[Paragraph]
  Sent1[Sentence]
  Paper2[Paper]
  Paper1 -->|BELONGS_TO| Para1
  Para1 -->|BELONGS_TO| Paper1
  Sent1 -->|BELONGS_TO| Para1
  Sent1 -->|BELONGS_TO| Paper1
  Sent1 -->|CITES| Paper2
  Para1 -->|CITES| Paper2
```


## ğŸ§¬ Embedding Database Structure (Qdrant/VectorDB)

### Collections
- `claims`ï¼šå¥å­/claimçº§å‘é‡
- `paragraphs`ï¼šæ®µè½çº§å‘é‡
- `sections`ï¼šç« èŠ‚çº§å‘é‡
- `citations`ï¼šå¼•ç”¨æ–‡æœ¬å‘é‡

### å‘é‡ç»´åº¦
- `size`: 384 (å¦‚ all-MiniLM-L6-v2)
- `distance`: Cosine

### æ¯ä¸ªå‘é‡çš„å…ƒæ•°æ®ï¼ˆpayloadï¼‰
- `paper_id`: string (ä¸Graphä¸­çš„PaperèŠ‚ç‚¹idä¸€è‡´)
- `sentence_index`/`paragraph_index`/`section_index`: int
- `text`: string (åŸå§‹æ–‡æœ¬)
- `claim_type`: string (å¦‚æœ‰)
- `title`: string
- `authors`: list of string
- `year`: string/int
- `doi`: string
- `journal`: string
- `publisher`: string

### å­˜å‚¨ç»“æ„
- æ¯ä¸ª collection ä¸‹æœ‰å¤šä¸ªå‘é‡ç‚¹ï¼ˆPointStructï¼‰ï¼Œæ¯ä¸ªç‚¹æœ‰å”¯ä¸€ idã€å‘é‡ã€payload
- æ”¯æŒæŒ‰ `paper_id` èšåˆæ£€ç´¢ï¼Œå®ç°æ•´ç¯‡è®ºæ–‡çš„è¯­ä¹‰èšåˆ

### ç»“æ„ç¤ºæ„

```text
collection: claims
  - id: uuid
    vector: [float, ...] (384ç»´)
    payload:
      paper_id: "..."
      sentence_index: 0
      text: "..."
      claim_type: "..."
      title: "..."
      authors: ["..."]
      year: "..."
      ...
collection: paragraphs
  - id: uuid
    vector: [float, ...]
    payload: {...}
...
```

## å¤‡æ³¨
- Paper ID ç»Ÿä¸€ç”± PaperIDGenerator ç”Ÿæˆï¼ˆSHA256 hashï¼Œç¡®ä¿å…¨å±€å”¯ä¸€ï¼‰
- æ‰€æœ‰èŠ‚ç‚¹ã€å‘é‡çš„ `paper_id` å­—æ®µä¿æŒä¸€è‡´ï¼Œå®ç°å¤šæ¨¡æ€æ•°æ®çš„è·¨åº“å…³è”
- Graphæ•°æ®åº“å’ŒEmbeddingæ•°æ®åº“å¯é€šè¿‡ `paper_id` å®ç°é«˜æ•ˆè”åŠ¨ 